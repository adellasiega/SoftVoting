# Logistic Regression

Load the train data set on which ROSE was applied
```{r}
train_rose <- read.csv("data/train_rose.csv")
test <- read.csv("data/test.csv")
```

Fit the model
```{r}
logistic_model <- glm(CARAVAN ~ ., data = train_rose, family = "binomial")
```

```{r}
summary(logistic_model)
```

```{r}
x_test <- test[, !names(test) == "CARAVAN"]
y_pred <- as.numeric(predict(logistic_model,
                             newdata = x_test,
                             type = "response") > 0.5)

```
Make predictions of the test set

```{r}
#Confusion matrix
library(caret)
#change the positive class to 1
confusionMatrix(factor(y_pred), factor(test$CARAVAN), positive = "1")
```

```{r}
# Get the variables whose coefficient has p-value < 0.05
summ <- summary(logistic_model)
selected_vars <- summ$coefficients[summ$coefficients[, 4] < 0.05, ]
#Get only the names of the variables, excluding the intercept and including 
#the target variable
selected_vars <- c(rownames(selected_vars)[-1], "CARAVAN")
```
```{r}
#make a train set with only the selected variables
train_truncated <- train_rose[, selected_vars]
```
```{r}
logistic_model <- glm(CARAVAN ~ .,
                      data = train_truncated,
                      family = "binomial")

```
```{r}
#test the truncated model
x_test_truncated <- test[, selected_vars[-length(selected_vars)]]

y_pred <- as.numeric(predict(logistic_model,
                             newdata = x_test_truncated,
                             type = "response") > 0.5)

confusionMatrix(factor(y_pred), factor(test$CARAVAN), positive = "1")
```
