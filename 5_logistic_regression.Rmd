# Logistic Regression

Load the train data set on which ROSE was applied
```{r}
train_rose <- read.csv("data/train_rose.csv")
test <- read.csv("data/test.csv")
```

```{r}
str(train_rose)
```
The variable MOSTYPE.41 is a dummy variable that is redundant. We will remove it when fitting the model.

```{r}
logistic_model <- glm(CARAVAN ~ . - MOSTYPE.41,
                      data = train_rose,
                      family = "binomial")
```

```{r}
summary(logistic_model)
```

Confusion matrix on the train set:
```{r}
library(caret)
y_pred <- as.numeric(predict(logistic_model, type = "response") > 0.5)
confusionMatrix(factor(y_pred), factor(train_rose$CARAVAN), positive = "1")
```

## VIF analysis
Evaluate the Variance Inflation Factor (VIF) for the model and remove the variables whose VIF is greater than 10.
```{r}
library(car)
vif_analysis <- vif(logistic_model)
variables_to_remove <- names(vif_analysis[vif_analysis > 10])
print(variables_to_remove)
```

```{r}
# Create a string that represents the formula
formula_str <- paste("CARAVAN ~ . -MOSTYPE.41 -", paste(variables_to_remove, collapse = " - "))

# Convert the string to a formula
formula <- as.formula(formula_str)

# Fit the model
logistic_model <- glm(formula,
                      data = train_rose,
                      family = "binomial")
```


