---
title: "Train-Test Split"
output: html_notebook
---

# Data Cleaning

```{r}
data <- read.csv("data/caravan-insurance-challenge.csv")
```
Load the data.

```{r}
dim(data)
```
Number of rows and columns.

```{r}
sum(is.na(data))
```
Number of missing values. No missing values are present in the data.

```{r}
str(data)
```
Check the data types. All the variables are numeric (int) except the 'ORIGIN' variable which is a chr. According to the data description (https://www.kaggle.com/datasets/uciml/caravan-insurance-challenge), all the variables can be thought as categorical except MAANTHUI' (avg size household) and 'MEGEMOMV' (avg size hosehold). For each group of variables exists a specific encoding (L0, L1, L2, L3). Because of the encoding, the variables that belong to L0 and L2 ('MOSTYPE', 'MOSHOOFD') require a one hot encoding.

```{r}
# Perform one hot encoding on the variables 'MOSTYPE', 'MOSHOOFD'
library(caret)
vars_to_dummy <- c("MOSTYPE", "MOSHOOFD")
# convert the vars_to_dummy to factor
data[, vars_to_dummy] <- lapply(data[, vars_to_dummy], factor)
# perform one hot encoding
dummy <- dummyVars(" ~ .", data = data)
data <- data.frame(predict(dummy, newdata = data))
### Note that also the 'ORIGIN' variable is encoded!!!
```

```{r}
str(data)
```


# Train-Test Split
```{r}
str(data)
```

```{r}
train <- data[data$ORIGINtrain == 1, ]
test <- data[data$ORIGINtest == 1, ]
```
Perform the train-test split according to the variable.

```{r}
train <- train[, -which(names(train) == "ORIGINtest")]
train <- train[, -which(names(train) == "ORIGINtrain")]
test <- test[, -which(names(test) == "ORIGINtest")]
test <- test[, -which(names(test) == "ORIGINtrain")]
```
Remove the 'ORIGIN' variable from the data.

```{r}
dim(train)
```

```{r}
dim(test)
```

```{r}
write.csv(train, "data/train.csv", row.names = FALSE)
write.csv(test, "data/test.csv", row.names = FALSE)
```
Save the train and test data.